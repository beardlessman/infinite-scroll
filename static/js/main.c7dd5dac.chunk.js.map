{"version":3,"sources":["api/request.ts","constants/config.ts","api/index.ts","redux/reducers.ts","redux/modules/feed/reducers.ts","redux/modules/feed/actions/getFeed.ts","redux/middlewares/apiMiddleware.ts","helpers/isFunction.ts","helpers/isPromise.ts","redux/configureStore.ts","components/Header/index.tsx","components/Layout/index.tsx","components/Sticky/index.tsx","components/Panel/index.tsx","components/Item/index.tsx","helpers/getRandomInteger.ts","features/Feed/index.tsx","pages/FeedPage/index.tsx","App.tsx","index.tsx"],"names":["axios","create","baseURL","headers","Content-Type","api","getFeed","params","resource","id","concat","request","get","combineReducers","feed","INITIAL_STATE","list","isLoaded","isLoading","state","arguments","length","undefined","action","type","payload","Object","objectSpread","FeedReducer","apiMiddleware","_ref","dispatch","getState","next","func","promise","toString","call","obj","actionPromise","then","response","catch","errors","configureStore","middlewares","thunk","createLogger","collapsed","createStore","rootReducer","compose","applyMiddleware","apply","Header","react","className","this","props","children","React","Layout","components_Header","cx","require","bind","Sticky","_this","classCallCheck","possibleConstructorReturn","getPrototypeOf","relativeChildrenRef","setRelativeChildrenRef","ref","updateSticky","console","log","bounding","getBoundingClientRect","top","window","innerHeight","isActive","setState","addEventListener","removeEventListener","_this$props","sticky__container","sticky__container_active","Panel","Item","data","title","getRandomInteger","min","max","rand","Math","random","round","Feed","onScroll","scrollY","document","body","offsetHeight","increaseFeed","map","item","index","components_Item","key","connect","FeedPage","components_Sticky","components_Panel","features_Feed","App","components_Layout","pages_FeedPage","store","ReactDOM","render","react_default","a","createElement","es","src_App","getElementById"],"mappings":"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","file":"static/js/main.c7dd5dac.chunk.js","sourcesContent":["import axios from 'axios';\nimport config from '../constants/config';\n\nexport default axios.create({\n  baseURL: config.API_URL,\n  headers: {\n    'Content-Type': 'application/json'\n  }\n});\n","export default {\n  API_URL: 'https://jsonplaceholder.typicode.com/',\n};\n","import request from './request';\n\nconst endpoint = 'posts';\n\nconst api = {\n  getFeed: (params: { id?: string | number }) => {\n    const resource = params.id ? `${endpoint}?userId=${params.id}` : endpoint;\n    return request.get(`${resource}`);\n  },\n};\n\nexport default api;\n","import { combineReducers } from 'redux';\nimport { FeedReducer } from './modules/feed/reducers';\n\nexport default combineReducers({\n  feed: FeedReducer(),\n});\n","import { GET_FEED_REQUEST, GET_FEED_SUCCESS, GET_FEED_FAILURE } from './actions';\nimport { IFeedState } from './types';\n\nexport const FeedReducer = () => {\n  const INITIAL_STATE: IFeedState = {\n    list: [],\n    isLoaded: false,\n    isLoading: false,\n  };\n\n  return (state = INITIAL_STATE, action): IFeedState => {\n    const { type, payload } = action;\n\n    switch (type) {\n      case GET_FEED_REQUEST:\n        return {\n          ...state,\n          isLoading: true,\n        };\n\n      case GET_FEED_SUCCESS:\n        return {\n          ...state,\n          list: state.list.concat(payload),\n          isLoading: false,\n          isLoaded: true,\n        };\n\n      case GET_FEED_FAILURE:\n        return {\n          ...state,\n          isLoading: false,\n        };\n\n      default:\n        return state;\n    }\n  };\n};\n","import { AxiosResponse } from 'axios';\nimport api from '../../../../api';\n\nexport const GET_FEED_REQUEST = 'GET_FEED_REQUEST';\nexport const GET_FEED_SUCCESS = 'GET_FEED_SUCCESS';\nexport const GET_FEED_FAILURE = 'GET_FEED_FAILURE';\nexport const GET_FEED_CANCEL = 'GET_FEED_CANCEL';\n\nexport const getFeed = (id: number): any => {\n  return dispatch => {\n    return dispatch({\n      type: GET_FEED_REQUEST,\n      promise: () => api.getFeed({ id }),\n    })\n      .then((response: AxiosResponse) => {\n        dispatch({ type: GET_FEED_SUCCESS, payload: response.data });\n        return response;\n      })\n      .catch((errors: any) => {\n        dispatch({ type: GET_FEED_FAILURE, payload: errors });\n        throw errors;\n      });\n  };\n};\n","import { AxiosResponse } from 'axios';\nimport isFunction from '../../helpers/isFunction';\nimport isPromise from '../../helpers/isPromise';\nimport { Middleware } from 'redux';\nimport IRootState from '../IRootState';\n\nconst apiMiddleware: Middleware<{}, IRootState, any> = ({ dispatch, getState }) => {\n  return next => action => {\n    if (!isFunction(action.promise)) {\n      return next(action);\n    }\n\n    let actionPromise = action.promise();\n\n    if (!isPromise(actionPromise)) {\n      return next(action);\n    }\n\n    action.type && dispatch({ type: action.type });\n\n    return actionPromise\n      .then((response: AxiosResponse) => {\n        return response;\n      })\n      .catch((errors: any) => {\n        throw errors;\n      });\n  };\n};\n\nexport default apiMiddleware;\n","export default func => func && {}.toString.call(func) === '[object Function]';\n","export default obj => !!obj && (typeof obj === 'object' || typeof obj === 'function') && typeof obj.then === 'function';\n","import { createStore, applyMiddleware, compose } from 'redux';\nimport thunk from 'redux-thunk';\nimport { createLogger } from 'redux-logger';\nimport rootReducer from './reducers';\nimport apiMiddleware from './middlewares/apiMiddleware';\n\nconst configureStore = () => {\n  const middlewares = [apiMiddleware, thunk, createLogger({ collapsed: true })];\n  return createStore(rootReducer, compose((applyMiddleware as any)(...middlewares)));\n};\n\nexport default configureStore;\n","import * as React from 'react';\n\nimport './style.css';\n\nclass Header extends React.Component {\n  render() {\n    return (\n      <div className=\"header\">\n        <div className=\"header__inner\">{this.props.children}</div>\n      </div>\n    );\n  }\n}\n\nexport default Header;\n","import * as React from 'react';\n\nimport Header from '../../components/Header';\n\nimport './style.css';\n\nclass Layout extends React.Component {\n  render() {\n    return (\n      <div className=\"layout\">\n        <div className=\"layout__header\">\n          <Header>Infinite scroll demo</Header>\n        </div>\n        <div className=\"layout__content\">\n          <div className=\"layout__inner\">{this.props.children}</div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default Layout;\n","import * as React from 'react';\n\nconst cx = require('classnames/bind').bind(require('./style.css'));\n\ninterface IProps {\n  children: React.ReactChild;\n  className?: string;\n}\n\ninterface IState {\n  isActive: boolean;\n}\n\nclass Sticky extends React.PureComponent<IProps, IState> {\n  relativeChildrenRef: HTMLDivElement | any = null;\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      isActive: false,\n    };\n  }\n\n  setRelativeChildrenRef = (ref: HTMLDivElement) => (this.relativeChildrenRef = ref);\n\n  componentDidMount() {\n    window.addEventListener('resize', this.updateSticky);\n    window.addEventListener('scroll', this.updateSticky);\n    typeof window !== 'undefined' && this.updateSticky();\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener('resize', this.updateSticky);\n    window.removeEventListener('scroll', this.updateSticky);\n  }\n\n  updateSticky = () => {\n      console.log('update sticky');\n      \n    const bounding = this.relativeChildrenRef.getBoundingClientRect();\n    console.log(bounding.top);\n    console.log(window.innerHeight);\n    // const isActive = window.innerHeight < bounding.top + 58;\n    const isActive = bounding.top < 0;\n    if (this.state.isActive && !isActive) {\n      this.setState({ isActive: false });\n    } else if (!this.state.isActive && isActive) {\n      this.setState({ isActive: true });\n    }\n  };\n\n  render() {\n    const { children, className } = this.props;\n    const { isActive } = this.state;\n\n    return (\n      <div className={cx(className, 'sticky')}>\n        <div\n          className={cx({\n            sticky__container: true,\n            sticky__container_active: isActive,\n          })}\n        >\n          {children}\n        </div>\n        <div ref={this.setRelativeChildrenRef} />\n      </div>\n    );\n  }\n}\n\nexport default Sticky;\n","import * as React from 'react';\n\nimport './style.css';\n\nclass Panel extends React.Component {\n  render() {\n    return <div className='panel'>{this.props.children}</div>;\n  }\n}\n\nexport default Panel;\n","import * as React from 'react';\nimport IFeedItem from '../../types/IFeedItem';\n\nimport './style.css';\n\ninterface IProps {\n  data: IFeedItem;\n}\n\nclass Item extends React.Component<IProps> {\n  render() {\n    return <div className=\"item\">{this.props.data.title}</div>;\n  }\n}\n\nexport default Item;\n","export default (min: number, max: number) => {\n  let rand = min - 0.5 + Math.random() * (max - min + 1);\n  rand = Math.round(rand);\n  return rand;\n};\n","import * as React from 'react';\nimport { connect } from 'react-redux';\nimport { AxiosResponse } from 'axios';\nimport Item from '../../components/Item';\nimport { IFeedState } from '../../redux/modules/feed/types';\nimport { getFeed } from '../../redux/modules/feed/actions';\nimport getRandomInteger from '../../helpers/getRandomInteger';\nimport IRootState from '../../redux/IRootState';\n\ninterface IStateToProps {\n  feed: IFeedState;\n}\n\ninterface IDispatchToProps {\n  getFeed: (id: number) => Promise<AxiosResponse>;\n}\n\n// import './style.css';\n\nclass Feed extends React.Component<IStateToProps & IDispatchToProps> {\n  componentDidMount() {\n    this.props.getFeed(1);\n    window.addEventListener('scroll', this.onScroll, false);\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener('scroll', this.onScroll, false);\n  }\n\n  onScroll = () => {\n    if (window.innerHeight + window.scrollY >= document.body.offsetHeight - 100 && this.props.feed.list.length) {\n      this.increaseFeed();\n    }\n  };\n\n  increaseFeed = () => {\n    if (!this.props.feed.isLoading) {\n      this.props.getFeed(getRandomInteger(1, 10));\n    }\n  };\n\n  render() {\n    const { list } = this.props.feed;\n\n    return (\n      <div className=\"feed\">\n        {list.map((item, index) => (\n          <Item key={index} data={item} />\n        ))}\n        {this.props.feed.isLoading && <span>Loading...</span>}\n      </div>\n    );\n  }\n}\n\nexport default connect<IStateToProps, IDispatchToProps>(\n  (state: IRootState | any) => ({\n    feed: state.feed,\n  }),\n  {\n    getFeed,\n  },\n)(Feed);\n","import * as React from 'react';\nimport Sticky from '../../components/Sticky';\nimport Panel from '../../components/Panel';\nimport Feed from '../../features/Feed';\n\nimport './style.css';\n\nclass FeedPage extends React.Component {\n  render() {\n    return (\n      <div className=\"page\">\n        <Sticky className=\"page__header\">\n          <Panel>Верхняя панель</Panel>\n        </Sticky>\n        <div className=\"page__main\">\n          <Sticky className=\"page__sidebar\">\n            <Panel>Боковая панель</Panel>\n          </Sticky>\n          <div className=\"page__content\">\n            <Feed />\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default FeedPage;\n","import * as React from 'react';\nimport Layout from './components/Layout';\nimport FeedPage from './pages/FeedPage';\n\nclass App extends React.Component {\n  render() {\n    return (\n      <Layout>\n        <FeedPage />\n      </Layout>\n    );\n  }\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { Provider } from 'react-redux';\nimport configureStore from './redux/configureStore';\nimport App from './App';\n\nimport './index.css';\n\nconst store = configureStore();\n\nReactDOM.render(\n  <Provider store={store}>\n    <App />\n  </Provider>,\n  document.getElementById('root'),\n);\n"],"sourceRoot":""}